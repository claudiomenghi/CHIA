<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="it"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>ConfParser.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">CHIAScalabilityEvaluator</a> &gt; <a href="index.source.html" class="el_package">it.polimi.chia.scalability.parsers</a> &gt; <span class="el_source">ConfParser.java</span></div><h1>ConfParser.java</h1><pre class="source lang-java linenums">package it.polimi.chia.scalability.parsers;

import java.io.BufferedReader;
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.io.InputStreamReader;
import java.net.URISyntaxException;

import com.google.common.base.Preconditions;

/**
 * The parser to be used to load the parsing parameters
 * 
 * @author Claudio Menghi
 *
 */
public class ConfParser {

	/**
	 * contains the file where the results of the parsing are written
	 */
	private final static String RESULT_FILE = &quot;RESULTS:&quot;;

	/**
	 * contains the file where the possible results of the parsing are written
	 */
	private final static String RESULT_FILE_POSSIBLY = &quot;RESULTSPOSSIBLY:&quot;;

	/**
	 * contains the directory where the results are written
	 */
	private final static String TESTD_IRECTORY = &quot;TESTDIRECTORY&quot;;

	/**
	 * the number of tests to be performed
	 */
	private final static String N_TESTS = &quot;N_TESTS&quot;;

	// NUMBER OF STATES
	private final static String INIT_NSTATES = &quot;INIT_NSTATES&quot;;
	private final static String FINAL_NSTATES = &quot;FINAL_NSTATES&quot;;
	private final static String INCREMENT_NSTATES = &quot;INCREMENT_NSTATES&quot;;
	private final static String CURRENT_NSTATES = &quot;CURRENT_NSTATES&quot;;

	// TRANSITIONS DENSITIES
	private static final String INIT_TRANSITION_DENSITY = &quot;INIT_TRANSITION_DENSITY&quot;;
	private static final String FINAL_TRANSITION_DENSITY = &quot;FINAL_TRANSITION_DENSITY&quot;;
	private static final String INCREMENT_TRANSITION_DENSITY = &quot;INCREMENT_TRANSITION_DENSITY&quot;;

	// ACCEPTING DENSITIES
	private static final String INIT_ACCEPTING_DENSITY = &quot;INIT_ACCEPTING_DENSITY&quot;;
	private static final String FINAL_ACCEPTING_DENSITY = &quot;FINAL_ACCEPTING_DENSITY&quot;;
	private static final String INCREMENT_ACCEPTING_DENSITY = &quot;INCREMENT_ACCEPTING_DENSITY&quot;;

	// TRANSPARENT DENSITIES
	private static final String INIT_TRANSPARENT_DENSITY = &quot;INIT_TRANSPARENT_DENSITY&quot;;
	private static final String FINAL_TRANSPARENT_DENSITY = &quot;FINAL_TRANSPARENT_DENSITY&quot;;
	private static final String INCREMENT_TRANSPARENT_DENSITY = &quot;INCREMENT_TRANSPARENT_DENSITY&quot;;

	// REPLACEMENT DENSITIES
	private static final String INIT_REPLACEMENT_DENSITY = &quot;INIT_REPLACEMENT_DENSITY&quot;;
	private static final String FINAL_REPLACEMENT_DENSITY = &quot;FINAL_REPLACEMENT_DENSITY&quot;;
	private static final String INCREMENT_REPLACEMENT_DENSITY = &quot;INCREMENT_REPLACEMENT_DENSITY&quot;;



	private static final String CURRENT_CONFIGURATION = &quot;CURRENT_CONFIGURATION&quot;;
	/**
	 * the file where the results must be written
	 */
	private String resultsFile;

	/**
	 * the file where the results of the possibly satisfied claim must be
	 * written
	 */
	private String resultsFilePossibly;

	/**
	 * the directory where the results must be written
	 */
	private String testDirectory;

	/**
	 * the number of tests to be performed
	 */
	private int numberOfTests;

	// NUMBER OF STATES
	/**
	 * contains the initial number of states
	 */
	private int initialNumberOfStates;

	/**
	 * contains the final number of states
	 */
	private int finalNumberOfStates;

	/**
	 * contains the increment over the number of the states
	 */
	private int incrementNumberOfStates;

	/**
	 * contains the currentNumberOfStates
	 */
	private int currentNumberOfStates;

	// TRANSITION DENSITIES
	/**
	 * contains the initial number of transitions
	 */
	private double initialTransitionDensity;
	/**
	 * contains the final transition density
	 */
	private double finalTransitionDensity;
	/**
	 * contains the increment over the transition density
	 */
	private double incrementTransitionDensity;
	/**
	 * contains the current transition density
	 */
	private double currentTransitionDensity;

	// ACCEPTING DENSITIES
	/**
	 * the initial density of accepting states
	 */
	private double initialAcceptingDensity;
	/**
	 * the final density of accepting states
	 */
	private double finalAcceptingDensity;
	/**
	 * the increment over the number of accepting states
	 */
	private double incrementAcceptingDensity;

	// TRANSPARENT DENSITIES
	/**
	 * the initial density of transparent states
	 */
	private double initialTransparentDensity;
	/**
	 * the final density of transparent states
	 */
	private double finalTransparentDensity;
	/**
	 * the increment over the density of transparent states
	 */
	private double incrementTransparentDensity;

	// REPLACEMENT DENSITIES
	/**
	 * the initial replacement density
	 */
	private double initialReplacementDensity;
	/**
	 * the final replacement density
	 */
	private double finalreplacementDensity;
	/**
	 * increment replacement density
	 */
	private double incrementReplacementDensity;
	
	
	/**
	 * The current configuration
	 */
	private int currentConfiguration;

	/**
	 * The parser of the conf file
	 * 
	 * @param confFile
	 *            the file to be parsed
	 * @throws IOException
	 * @throws URISyntaxException
	 * @throws NullPointerException
	 *             is thrown if the configuration file is null
	 * 
	 */
<span class="nc" id="L188">	public ConfParser(String confFile) throws IOException, URISyntaxException {</span>
<span class="nc" id="L189">		Preconditions.checkNotNull(confFile,</span>
				&quot;The file to be considered cannot be null&quot;);
<span class="nc bnc" id="L191" title="All 2 branches missed.">		if(ClassLoader.getSystemResource(confFile)==null){</span>
<span class="nc" id="L192">			throw new IllegalArgumentException(&quot;The file &quot;+confFile+&quot; has not been found&quot;);</span>
		}
<span class="nc" id="L194">		File f = new File(ClassLoader.getSystemResource(confFile).toURI());</span>
<span class="nc bnc" id="L195" title="All 4 branches missed.">		Preconditions.checkState(f.exists() &amp;&amp; !f.isDirectory(), &quot;The file &quot;</span>
				+ confFile + &quot; does not exists&quot;);
<span class="nc" id="L197">		this.currentConfiguration = 1;</span>
<span class="nc" id="L198">		this.parse(f);</span>
<span class="nc" id="L199">	}</span>

	private void parse(File f) throws IOException {
<span class="nc" id="L202">		FileInputStream inputStream = new FileInputStream(f);</span>
<span class="nc" id="L203">		BufferedReader br = new BufferedReader(new InputStreamReader(</span>
				inputStream));
<span class="nc" id="L205">		String line = null;</span>
<span class="nc bnc" id="L206" title="All 2 branches missed.">		while ((line = br.readLine()) != null) {</span>
<span class="nc" id="L207">			this.parseLine(line);</span>
		}
<span class="nc" id="L209">		br.close();</span>
<span class="nc" id="L210">	}</span>

	private void parseLine(String line) {
<span class="nc bnc" id="L213" title="All 2 branches missed.">		if (line.startsWith(RESULT_FILE)) {</span>
<span class="nc" id="L214">			this.resultsFile = line.substring(RESULT_FILE.length() + 1);</span>
		}
<span class="nc bnc" id="L216" title="All 2 branches missed.">		if (line.startsWith(RESULT_FILE_POSSIBLY)) {</span>
<span class="nc" id="L217">			this.resultsFilePossibly = line.substring(RESULT_FILE_POSSIBLY</span>
<span class="nc" id="L218">					.length() + 1);</span>
		}
<span class="nc bnc" id="L220" title="All 2 branches missed.">		if (line.startsWith(TESTD_IRECTORY)) {</span>
<span class="nc" id="L221">			this.testDirectory = line.substring(TESTD_IRECTORY.length() + 2);</span>
		}
<span class="nc bnc" id="L223" title="All 2 branches missed.">		if (line.startsWith(N_TESTS)) {</span>
<span class="nc" id="L224">			this.numberOfTests = Integer.parseInt(line.substring(N_TESTS</span>
<span class="nc" id="L225">					.length() + 2));</span>
		}
		
<span class="nc bnc" id="L228" title="All 2 branches missed.">		if (line.startsWith(CURRENT_CONFIGURATION)) {</span>
<span class="nc" id="L229">			this.currentConfiguration = Integer.parseInt(line</span>
<span class="nc" id="L230">					.substring(CURRENT_CONFIGURATION.length() + 2));</span>
		}
		
<span class="nc" id="L233">		checkNumberOfStates(line);</span>
<span class="nc" id="L234">		checkTransitionDensities(line);</span>
		// ACCEPTING DENSITY
<span class="nc" id="L236">		checkAcceptingStates(line);</span>
<span class="nc" id="L237">		checkTransparentStates(line);</span>
<span class="nc" id="L238">		checkReplacementDensity(line);</span>
<span class="nc" id="L239">	}</span>
	
	
	private void checkReplacementDensity(String line) {
<span class="nc bnc" id="L243" title="All 2 branches missed.">		if (line.startsWith(INIT_REPLACEMENT_DENSITY)) {</span>
<span class="nc" id="L244">			this.initialReplacementDensity = Double.parseDouble(line</span>
<span class="nc" id="L245">					.substring(INIT_REPLACEMENT_DENSITY.length() + 2));</span>
		}
<span class="nc bnc" id="L247" title="All 2 branches missed.">		if (line.startsWith(FINAL_REPLACEMENT_DENSITY)) {</span>
<span class="nc" id="L248">			this.finalreplacementDensity = Double.parseDouble(line</span>
<span class="nc" id="L249">					.substring(FINAL_REPLACEMENT_DENSITY.length() + 2));</span>
		}
<span class="nc bnc" id="L251" title="All 2 branches missed.">		if (line.startsWith(INCREMENT_REPLACEMENT_DENSITY)) {</span>
<span class="nc" id="L252">			this.incrementReplacementDensity = Double.parseDouble(line</span>
<span class="nc" id="L253">					.substring(INCREMENT_REPLACEMENT_DENSITY.length() + 2));</span>
		}
<span class="nc" id="L255">	}</span>

	private void checkTransparentStates(String line) {
<span class="nc bnc" id="L258" title="All 2 branches missed.">		if (line.startsWith(INIT_TRANSPARENT_DENSITY)) {</span>
<span class="nc" id="L259">			this.initialTransparentDensity = Double.parseDouble(line</span>
<span class="nc" id="L260">					.substring(INIT_TRANSPARENT_DENSITY.length() + 2));</span>
		}
<span class="nc bnc" id="L262" title="All 2 branches missed.">		if (line.startsWith(FINAL_TRANSPARENT_DENSITY)) {</span>
<span class="nc" id="L263">			this.finalTransparentDensity = Double.parseDouble(line</span>
<span class="nc" id="L264">					.substring(FINAL_TRANSPARENT_DENSITY.length() + 2));</span>
		}
<span class="nc bnc" id="L266" title="All 2 branches missed.">		if (line.startsWith(INCREMENT_TRANSPARENT_DENSITY)) {</span>
<span class="nc" id="L267">			this.incrementTransparentDensity = Double.parseDouble(line</span>
<span class="nc" id="L268">					.substring(INCREMENT_TRANSPARENT_DENSITY.length() + 2));</span>
		}
<span class="nc" id="L270">	}</span>

	private void checkAcceptingStates(String line) {
<span class="nc bnc" id="L273" title="All 2 branches missed.">		if (line.startsWith(INIT_ACCEPTING_DENSITY)) {</span>
<span class="nc" id="L274">			this.initialAcceptingDensity = Double.parseDouble(line</span>
<span class="nc" id="L275">					.substring(INIT_ACCEPTING_DENSITY.length() + 2));</span>
		}
<span class="nc bnc" id="L277" title="All 2 branches missed.">		if (line.startsWith(FINAL_ACCEPTING_DENSITY)) {</span>
<span class="nc" id="L278">			this.finalAcceptingDensity = Double.parseDouble(line</span>
<span class="nc" id="L279">					.substring(FINAL_ACCEPTING_DENSITY.length() + 2));</span>
		}
<span class="nc bnc" id="L281" title="All 2 branches missed.">		if (line.startsWith(INCREMENT_ACCEPTING_DENSITY)) {</span>
<span class="nc" id="L282">			this.incrementAcceptingDensity = Double.parseDouble(line</span>
<span class="nc" id="L283">					.substring(INCREMENT_ACCEPTING_DENSITY.length() + 2));</span>
		}
<span class="nc" id="L285">	}</span>

	private void checkTransitionDensities(String line) {
		// TRANSITION DENSITY
<span class="nc bnc" id="L289" title="All 2 branches missed.">		if (line.startsWith(INIT_TRANSITION_DENSITY)) {</span>
<span class="nc" id="L290">			this.initialTransitionDensity = Double.parseDouble(line</span>
<span class="nc" id="L291">					.substring(INIT_TRANSITION_DENSITY.length() + 2));</span>
		}
<span class="nc bnc" id="L293" title="All 2 branches missed.">		if (line.startsWith(FINAL_TRANSITION_DENSITY)) {</span>
<span class="nc" id="L294">			this.finalTransitionDensity = Double.parseDouble(line</span>
<span class="nc" id="L295">					.substring(FINAL_TRANSITION_DENSITY.length() + 2));</span>
		}
<span class="nc bnc" id="L297" title="All 2 branches missed.">		if (line.startsWith(INCREMENT_TRANSITION_DENSITY)) {</span>
<span class="nc" id="L298">			this.incrementTransitionDensity = Double.parseDouble(line</span>
<span class="nc" id="L299">					.substring(INCREMENT_TRANSITION_DENSITY.length() + 2));</span>
		}
<span class="nc" id="L301">	}</span>

	private void checkNumberOfStates(String line) {
		// NUMBER OF STATES
<span class="nc bnc" id="L305" title="All 2 branches missed.">		if (line.startsWith(INIT_NSTATES)) {</span>
<span class="nc" id="L306">			this.initialNumberOfStates = Integer.parseInt(line</span>
<span class="nc" id="L307">					.substring(INIT_NSTATES.length() + 2));</span>
		}
<span class="nc bnc" id="L309" title="All 2 branches missed.">		if (line.startsWith(FINAL_NSTATES)) {</span>
<span class="nc" id="L310">			this.finalNumberOfStates = Integer.parseInt(line</span>
<span class="nc" id="L311">					.substring(FINAL_NSTATES.length() + 2));</span>
		}
<span class="nc bnc" id="L313" title="All 2 branches missed.">		if (line.startsWith(INCREMENT_NSTATES)) {</span>
<span class="nc" id="L314">			this.incrementNumberOfStates = Integer.parseInt(line</span>
<span class="nc" id="L315">					.substring(INCREMENT_NSTATES.length() + 2));</span>
		}
<span class="nc bnc" id="L317" title="All 2 branches missed.">		if (line.startsWith(CURRENT_NSTATES)) {</span>
<span class="nc" id="L318">			this.currentNumberOfStates = Integer.parseInt(line</span>
<span class="nc" id="L319">					.substring(CURRENT_NSTATES.length() + 2));</span>
		}
<span class="nc" id="L321">	}</span>

	/**
	 * @return the initAcceptingDensity
	 */
	public double getInitAcceptingDensity() {
<span class="nc" id="L327">		return this.initialAcceptingDensity;</span>
	}

	/**
	 * @return the finalAcceptingDensity
	 */
	public double getFinalAcceptingDensity() {
<span class="nc" id="L334">		return this.finalAcceptingDensity;</span>
	}

	/**
	 * @return the incrementAcceptingDensity
	 */
	public double getIncrementAcceptingDensity() {
<span class="nc" id="L341">		return this.incrementAcceptingDensity;</span>
	}

	/**
	 * @return the initialTransitionDensity
	 */
	public double getInitialTransitionDensity() {
<span class="nc" id="L348">		return initialTransitionDensity;</span>
	}

	/**
	 * @return the finalTransitionDensity
	 */
	public double getFinalTransitionDensity() {
<span class="nc" id="L355">		return finalTransitionDensity;</span>
	}

	/**
	 * @return the incrementTransitionDensity
	 */
	public double getIncrementTransitionDensity() {
<span class="nc" id="L362">		return incrementTransitionDensity;</span>
	}

	/**
	 * @return the finalNumberOfStates
	 */
	public int getFinalNumberOfStates() {
<span class="nc" id="L369">		return finalNumberOfStates;</span>
	}

	/**
	 * @return the incrementNumberOfStates
	 */
	public int getIncrementNumberOfStates() {
<span class="nc" id="L376">		return incrementNumberOfStates;</span>
	}

	/**
	 * @return the resultsFile
	 */
	public String getResultsFile() {
<span class="nc" id="L383">		return resultsFile;</span>
	}

	/**
	 * @return the resultsFilePossibly
	 */
	public String getResultsFilePossibly() {
<span class="nc" id="L390">		return resultsFilePossibly;</span>
	}

	/**
	 * @return the testDirectory
	 */
	public String getTestDirectory() {
<span class="nc" id="L397">		return testDirectory;</span>
	}

	/**
	 * @return the numberOfTests
	 */
	public int getNumberOfTests() {
<span class="nc" id="L404">		return numberOfTests;</span>
	}

	/**
	 * @return the initialNumberOfStates
	 */
	public int getInitialNumberOfStates() {
<span class="nc" id="L411">		return initialNumberOfStates;</span>
	}

	/**
	 * @return the initialTransparentDensity
	 */
	public double getInitialTransparentDensity() {
<span class="nc" id="L418">		return initialTransparentDensity;</span>
	}

	/**
	 * @return the finalTransparentDensity
	 */
	public double getFinalTransparentDensity() {
<span class="nc" id="L425">		return finalTransparentDensity;</span>
	}

	/**
	 * @return the incrementTransparentDensity
	 */
	public double getIncrementTransparentDensity() {
<span class="nc" id="L432">		return incrementTransparentDensity;</span>
	}

	/**
	 * @return the initialReplacementDensity
	 */
	public double getInitialReplacementDensity() {
<span class="nc" id="L439">		return initialReplacementDensity;</span>
	}

	/**
	 * @return the finalreplacementDensity
	 */
	public double getFinalReplacementDensity() {
<span class="nc" id="L446">		return finalreplacementDensity;</span>
	}

	/**
	 * @return the incrementReplacementDensity
	 */
	public double getIncrementReplacementDensity() {
<span class="nc" id="L453">		return incrementReplacementDensity;</span>
	}

	/**
	 * @return the currentNumberOfStates
	 */
	public int getCurrentNumberOfStates() {
<span class="nc" id="L460">		return currentNumberOfStates;</span>
	}

	/**
	 * @return the currentTransitionDensity
	 */
	public double getCurrentTransitionDensity() {
<span class="nc" id="L467">		return currentTransitionDensity;</span>
	}

	/**
	 * @return the currentConfiguration
	 */
	public int getCurrentConfiguration() {
<span class="nc" id="L474">		return currentConfiguration;</span>
	}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.2.201409121644</span></div></body></html>