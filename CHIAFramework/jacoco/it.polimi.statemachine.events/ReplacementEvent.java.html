<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="it"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>ReplacementEvent.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">CHIAFramework</a> &gt; <a href="index.source.html" class="el_package">it.polimi.statemachine.events</a> &gt; <span class="el_source">ReplacementEvent.java</span></div><h1>ReplacementEvent.java</h1><pre class="source lang-java linenums">package it.polimi.statemachine.events;

import it.polimi.console.CHIAReplacementConsole;

import java.io.PrintStream;
import java.text.ParseException;
import java.util.HashSet;
import java.util.LinkedList;
import java.util.List;
import java.util.Set;

import jline.console.completer.ArgumentCompleter;
import jline.console.completer.Completer;
import jline.console.completer.FileNameCompleter;
import jline.console.completer.StringsCompleter;

<span class="pc" id="L17">public enum ReplacementEvent implements CommandEvent&lt;CHIAReplacementConsole&gt; {</span>

<span class="fc" id="L19">    LOADCONSTRAINT {</span>

        @Override
        public String getCommandMeaning() {
<span class="fc" id="L23">            return &quot;loadConstraint&quot;;</span>
        }

        @Override
        public String getCommand() {
<span class="fc" id="L28">            return &quot;lc&quot;;</span>
        }

        @Override
        public String getDescription() {
<span class="fc" id="L33">            return &quot;It is used to load the constraint from an XML file. The XML file must mach the Constraint.xsd&quot;;</span>
        }

        @Override
        public String getParams() {
<span class="fc" id="L38">            return &quot;constraintFilePath:  the path of the file that contains the constraint to be loaded&quot;;</span>
        }

        @Override
        public boolean requiresParams() {
<span class="fc" id="L43">            return true;</span>
        }

        @Override
        public void executeCommand(String command,
                CHIAReplacementConsole console) throws Exception {
<span class="nc" id="L49">            console.loadConstraint(command.substring(command.indexOf(&quot; &quot;) + 1)</span>
<span class="nc" id="L50">                    .replaceAll(&quot; +$&quot;, &quot;&quot;));</span>
<span class="nc" id="L51">        }</span>

        /**
         * returns the String representation of the command
         * 
         * @return the String representation of the command
         */
        @Override
        public String toString() {
<span class="fc" id="L60">            return &quot;SYNOPSIS \n \t&quot; + this.getCommand() + &quot;\n&quot; + &quot;NAME \n \t&quot;</span>
<span class="fc" id="L61">                    + getCommandMeaning() + &quot;\n&quot; + &quot;PARAMS \n \t&quot;</span>
<span class="fc" id="L62">                    + this.getParams() + &quot;\n&quot; + &quot;DESCRIPTION &quot; + &quot;\n \t&quot;</span>
<span class="fc" id="L63">                    + this.getDescription() + &quot; \n &quot;;</span>
        }
    },
<span class="fc" id="L66">    HELP {</span>

        @Override
        public String getCommandMeaning() {
<span class="fc" id="L70">            return &quot;help&quot;;</span>
        }

        @Override
        public String getCommand() {
<span class="fc" id="L75">            return &quot;help&quot;;</span>
        }

        @Override
        public String getDescription() {
<span class="fc" id="L80">            return &quot;shows the params of the command.&quot;;</span>
        }

        @Override
        public String getParams() {
<span class="fc" id="L85">            return &quot;command: is the command to be performed&quot;;</span>
        }

        @Override
        public boolean requiresParams() {
<span class="fc" id="L90">            return true;</span>
        }

        @Override
        public void executeCommand(String command,
                CHIAReplacementConsole console) throws Exception {
<span class="nc" id="L96">            PrintStream out = System.out;</span>
<span class="nc" id="L97">            boolean founded = false;</span>
<span class="nc" id="L98">            String commandOfInterest = command</span>
<span class="nc" id="L99">                    .substring(command.indexOf(&quot; &quot;) + 1);</span>
<span class="nc bnc" id="L100" title="All 2 branches missed.">            for (ReplacementEvent analyzedCommand : ReplacementEvent.values()) {</span>
<span class="nc bnc" id="L101" title="All 2 branches missed.">                if (commandOfInterest.equals(analyzedCommand.getCommand())</span>
<span class="nc bnc" id="L102" title="All 2 branches missed.">                        &amp;&amp; !commandOfInterest.equals(HELP.getCommand())) {</span>

<span class="nc" id="L104">                    out.println(analyzedCommand.toString());</span>
<span class="nc" id="L105">                    founded = true;</span>
                }
            }
<span class="nc bnc" id="L108" title="All 2 branches missed.">            if (!founded) {</span>
<span class="nc" id="L109">                out.println(&quot;The command: &quot; + commandOfInterest</span>
                        + &quot; is not a valid command&quot;);
            }

<span class="nc" id="L113">        }</span>

    },

<span class="fc" id="L117">    DISPLAYCONSTRAINT {</span>

        @Override
        public String getCommandMeaning() {
<span class="fc" id="L121">            return &quot;displayConstraint&quot;;</span>
        }

        @Override
        public String getCommand() {
<span class="fc" id="L126">            return &quot;dispc&quot;;</span>
        }

        @Override
        public String getDescription() {
<span class="fc" id="L131">            return &quot;It is used to display the constraint into the console.&quot;;</span>
        }

        @Override
        public String getParams() {
<span class="fc" id="L136">            return null;</span>
        }

        @Override
        public boolean requiresParams() {
<span class="fc" id="L141">            return false;</span>
        }

        @Override
        public void executeCommand(String command,
                CHIAReplacementConsole console) throws Exception {
<span class="nc" id="L147">            console.dispConstraint();</span>
<span class="nc" id="L148">        }</span>

        /**
         * returns the String representation of the command
         * 
         * @return the String representation of the command
         */
        @Override
        public String toString() {
<span class="fc" id="L157">            return &quot;SYNOPSIS \n \t&quot; + this.getCommand() + &quot;\n&quot; + &quot;NAME \n \t&quot;</span>
<span class="fc" id="L158">                    + getCommandMeaning() + &quot;\n&quot; + &quot;PARAMS \n \t&quot;</span>
<span class="fc" id="L159">                    + this.getParams() + &quot;\n&quot; + &quot;DESCRIPTION &quot; + &quot;\n \t&quot;</span>
<span class="fc" id="L160">                    + this.getDescription() + &quot; \n &quot;;</span>
        }
    },

<span class="fc" id="L164">    LOADREPLACEMENT {</span>

        @Override
        public String getCommandMeaning() {
<span class="fc" id="L168">            return &quot;loadReplacement&quot;;</span>
        }

        @Override
        public String getCommand() {
<span class="fc" id="L173">            return &quot;lr&quot;;</span>
        }

        @Override
        public String getDescription() {
<span class="fc" id="L178">            return &quot;IT is used to load the replacement from an XML file. The XML file must mach the Replacement.xsd&quot;;</span>
        }

        @Override
        public String getParams() {
<span class="fc" id="L183">            return &quot;replacementFilePath: is the path of the file that contains the replacement to be considered&quot;;</span>
        }

        @Override
        public boolean requiresParams() {
<span class="fc" id="L188">            return true;</span>
        }

        @Override
        public void executeCommand(String command,
                CHIAReplacementConsole console) throws Exception {
<span class="nc" id="L194">            console.loadReplacement(command.substring(command.indexOf(&quot; &quot;) + 1)</span>
<span class="nc" id="L195">                    .replaceAll(&quot; +$&quot;, &quot;&quot;));</span>
<span class="nc" id="L196">        }</span>

        /**
         * returns the String representation of the command
         * 
         * @return the String representation of the command
         */
        @Override
        public String toString() {
<span class="fc" id="L205">            return &quot;SYNOPSIS \n \t&quot; + this.getCommand() + &quot;\n&quot; + &quot;NAME \n \t&quot;</span>
<span class="fc" id="L206">                    + getCommandMeaning() + &quot;\n&quot; + &quot;PARAMS \n \t&quot;</span>
<span class="fc" id="L207">                    + this.getParams() + &quot;\n&quot; + &quot;DESCRIPTION &quot; + &quot;\n \t&quot;</span>
<span class="fc" id="L208">                    + this.getDescription() + &quot; \n &quot;;</span>
        }
    },
<span class="fc" id="L211">    DISPLAYREPLACEMENT {</span>

        @Override
        public String getCommandMeaning() {
<span class="fc" id="L215">            return &quot;displayReplacement&quot;;</span>
        }

        @Override
        public String getCommand() {
<span class="fc" id="L220">            return &quot;dispr&quot;;</span>
        }

        @Override
        public String getDescription() {
<span class="fc" id="L225">            return &quot;It is used to display the replacement into the console.&quot;;</span>
        }

        @Override
        public String getParams() {
<span class="fc" id="L230">            return null;</span>
        }

        @Override
        public boolean requiresParams() {
<span class="fc" id="L235">            return false;</span>
        }

        @Override
        public void executeCommand(String command,
                CHIAReplacementConsole console) throws Exception {
<span class="nc" id="L241">            console.dispReplacement();</span>
<span class="nc" id="L242">        }</span>

        /**
         * returns the String representation of the command
         * 
         * @return the String representation of the command
         */
        @Override
        public String toString() {
<span class="fc" id="L251">            return &quot;SYNOPSIS \n \t&quot; + this.getCommand() + &quot;\n&quot; + &quot;NAME \n \t&quot;</span>
<span class="fc" id="L252">                    + getCommandMeaning() + &quot;\n&quot; + &quot;PARAMS \n \t&quot;</span>
<span class="fc" id="L253">                    + this.getParams() + &quot;\n&quot; + &quot;DESCRIPTION &quot; + &quot;\n \t&quot;</span>
<span class="fc" id="L254">                    + this.getDescription() + &quot; \n &quot;;</span>
        }

    },

<span class="fc" id="L259">    CHECK {</span>

        @Override
        public String getCommandMeaning() {
<span class="fc" id="L263">            return &quot;check&quot;;</span>
        }

        @Override
        public String getCommand() {
<span class="fc" id="L268">            return &quot;ck&quot;;</span>
        }

        @Override
        public String getDescription() {
<span class="fc" id="L273">            return &quot;It used to check the replacement against the constraint previously generated.&quot;;</span>
        }

        @Override
        public String getParams() {
<span class="fc" id="L278">            return null;</span>
        }

        @Override
        public boolean requiresParams() {
<span class="fc" id="L283">            return false;</span>
        }

        @Override
        public void executeCommand(String command,
                CHIAReplacementConsole console) throws Exception {
<span class="nc" id="L289">            console.replacementChecking();</span>
<span class="nc" id="L290">        }</span>

        /**
         * returns the String representation of the command
         * 
         * @return the String representation of the command
         */
        @Override
        public String toString() {
<span class="fc" id="L299">            return &quot;SYNOPSIS \n \t&quot; + this.getCommand() + &quot;\n&quot; + &quot;NAME \n \t&quot;</span>
<span class="fc" id="L300">                    + getCommandMeaning() + &quot;\n&quot; + &quot;PARAMS \n \t&quot; + &quot;\n&quot;</span>
<span class="fc" id="L301">                    + &quot;DESCRIPTION &quot; + &quot;\n \t&quot; + this.getDescription() + &quot; \n &quot;;</span>
        }

    },
<span class="fc" id="L305">    SAVEREFINEMENT {</span>

        @Override
        public String getCommandMeaning() {
<span class="fc" id="L309">            return &quot;save refinement&quot;;</span>
        }

        @Override
        public String getCommand() {
<span class="fc" id="L314">            return &quot;sref&quot;;</span>
        }

        @Override
        public String getDescription() {
<span class="fc" id="L319">            return &quot;starting from the intial model and the replacement associated to one of its black box states generate the corresponding&quot;</span>
                    + &quot;refinement.&quot;;
        }

        @Override
        public String getParams() {
<span class="fc" id="L325">            return &quot;The path of the file where the refinement must be saved&quot;;</span>
        }

        @Override
        public boolean requiresParams() {
<span class="fc" id="L330">            return true;</span>
        }

        @Override
        public void executeCommand(String command,
                CHIAReplacementConsole console) throws Exception {

<span class="nc" id="L337">            console.saveRefinement(command.substring(command.indexOf(&quot; &quot;) + 1)</span>
<span class="nc" id="L338">                    .replaceAll(&quot; +$&quot;, &quot;&quot;));</span>
<span class="nc" id="L339">        }</span>

    };
    public static void parse(String toBeParsed, CHIAReplacementConsole console)
            throws Exception {

<span class="nc" id="L345">        boolean founded = false;</span>
<span class="nc bnc" id="L346" title="All 2 branches missed.">        for (ReplacementEvent command : ReplacementEvent.values()) {</span>
<span class="nc bnc" id="L347" title="All 2 branches missed.">            if (toBeParsed.split(&quot; &quot;)[0].equals(command.getCommand())</span>
<span class="nc bnc" id="L348" title="All 2 branches missed.">                    || toBeParsed.equals(command.getCommand())) {</span>
<span class="nc" id="L349">                command.executeCommand(toBeParsed, console);</span>
<span class="nc" id="L350">                founded = true;</span>
            }
        }
<span class="nc bnc" id="L353" title="All 2 branches missed.">        if (!founded) {</span>
<span class="nc" id="L354">            throw new ParseException(&quot;The command &quot; + toBeParsed</span>
                    + &quot; is not a valid command&quot;, 0);
        }
<span class="nc" id="L357">    }</span>

    public static Set&lt;String&gt; getShortCuts() {
<span class="nc" id="L360">        Set&lt;String&gt; shortcuts = new HashSet&lt;String&gt;();</span>
<span class="nc bnc" id="L361" title="All 2 branches missed.">        for (ReplacementEvent command : ReplacementEvent.values()) {</span>
<span class="nc" id="L362">            shortcuts.add(command.getCommand());</span>
        }
<span class="nc" id="L364">        return shortcuts;</span>
    }

    public static Set&lt;String&gt; getCommands() {
<span class="fc" id="L368">        Set&lt;String&gt; commands = new HashSet&lt;String&gt;();</span>
<span class="fc bfc" id="L369" title="All 2 branches covered.">        for (ReplacementEvent command : ReplacementEvent.values()) {</span>
<span class="fc" id="L370">            commands.add(command.getCommand());</span>
        }
<span class="fc" id="L372">        return commands;</span>
    }

    public static List&lt;Completer&gt; computeCompleters() {
<span class="fc" id="L376">        List&lt;Completer&gt; chiaCompletors = new LinkedList&lt;Completer&gt;();</span>

<span class="fc bfc" id="L378" title="All 2 branches covered.">        for (ReplacementEvent alternative : ReplacementEvent.values()) {</span>

<span class="fc bfc" id="L380" title="All 2 branches covered.">            if (alternative.getParams() != null) {</span>
<span class="fc" id="L381">                chiaCompletors.add(new ArgumentCompleter(new StringsCompleter(</span>
<span class="fc" id="L382">                        alternative.getCommand()), new FileNameCompleter()));</span>

            } else {
<span class="fc" id="L385">                chiaCompletors.add(new StringsCompleter(alternative</span>
<span class="fc" id="L386">                        .getCommand()));</span>

            }
        }

<span class="fc" id="L391">        return chiaCompletors;</span>

    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.2.201409121644</span></div></body></html>